<% content_for :title do %>
  <% "OpenSplitTime: Show effort - #{@presenter.full_name} - #{@presenter.event_name}" %>
<% end %>

<% content_for(:container_type) do %>skip
<% end %>

<%= render "effort_header", view_object: @presenter, title: nil %>

<aside class="ost-toolbar" data-controller="roster">
  <div class="container">
    <div class="row">

      <% if current_user&.authorized_to_edit?(@presenter.effort) %>
        <div class="col">
          <div class="d-inline-flex">
            <span class="mx-1"><%= effort_actions_dropdown_menu(@presenter) %></span>
            <span class="mx-1"><%= render "start_stop_buttons", presenter: @presenter %></span>
            <% if @presenter.next_problem_effort %>
              <span class="mx-1"><%= link_to "Find a problem effort",
                                             effort_path(@presenter.next_problem_effort),
                                             class: "btn btn-success" %></span>
            <% end %>
            <span class="mx-1"><%= link_to "Raw time records (#{@presenter.raw_times_count})",
                                           raw_times_event_group_path(@presenter.event_group,
                                                                      filter: { bib_number: @presenter.bib_number },
                                                                      sort: [:absolute_time, :entered_time]),
                                           class: "btn btn-success" %></span>
          </div>
        </div>
      <% end %>

      <div class="col text-end">
        <div class="d-inline-flex">
          <% if current_user&.authorized_to_edit?(@presenter.effort) || current_user&.authorized_to_edit_personal?(@presenter.effort) %>
            <span class="mx-1"><%= render partial: "check_in_button", locals: { effort: @presenter.effort } %></span>
          <% end %>
          <% if @presenter.beacon_url %>
          <span class="mx-1"><%= link_to effort_beacon_button_text(@presenter.beacon_url),
                                         url_with_protocol(@presenter.beacon_url),
                                         class: "btn btn-outline-secondary",
                                         target: "_blank" %></span>
          <% end %>
          <% if @presenter.report_url %>
            <span class="mx-1"><%= link_to effort_report_button_text(@presenter.report_url),
                                           url_with_protocol(@presenter.report_url),
                                           class: "btn btn-outline-secondary",
                                           target: "_blank" %></span>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</aside>

<article class="ost-article container">

  <% if @presenter.lap_split_rows.present? %>
    <%= render "split_times/effort_show_table", presenter: @presenter %>
  <% end %>
</article>

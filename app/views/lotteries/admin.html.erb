<% content_for :title do %>
  <% "OpenSplitTime: Setup lottery - #{@presenter.name}" %>
<% end %>

<header class="ost-header">
  <div class="container">
    <div class="ost-heading row">
      <div class="col">
        <div class="ost-title">
          <h1><strong><%= "#{@presenter.name}: Admin" %></strong></h1>
          <ul class="breadcrumb breadcrumb-ost">
            <li class="breadcrumb-item"><%= link_to "Organizations", organizations_path %></li>
            <li class="breadcrumb-item"><%= link_to @presenter.organization.name, organization_lotteries_path(@presenter.organization) %></li>
            <li class="breadcrumb-item"><%= link_to "Lotteries", organization_lotteries_path(@presenter.organization) %></li>
            <li class="breadcrumb-item"><%= link_to @presenter.name, organization_lottery_path(@presenter.organization, @presenter.lottery) %></li>
            <li class="breadcrumb-item">Admin</li>
          </ul>
        </div>
        <div class="ost-subtitle">
          <p><%= l(@presenter.scheduled_start_date, format: :full_with_weekday) %></p>
        </div>
      </div>
      <aside class="col-auto">
        <%= link_to "Edit", edit_organization_lottery_path(@presenter.organization, @presenter.lottery), class: "btn btn-outline-secondary" %>
        <%= link_to "Public", organization_lottery_path(@presenter.organization, @presenter.lottery), class: "btn btn-outline-secondary" %>
      </aside>
    </div>
  </div>
</header>

<article class="ost-article container">
  <div class="row">
    <% @presenter.divisions.each do |division| %>
      <%= turbo_stream_from division, :lottery_draws %>
      <div class="col">
        <%= link_to division.name, draw_organization_lottery_path(@presenter.organization, @presenter.lottery, division_id: division.id),
                    method: :post,
                    class: "btn btn-lg btn-danger btn-block font-weight-bold" %>
        <hr/>
        <div id="<%= dom_id(division, :lottery_draws) %>">
          <%= render partial: "lottery_draws/lottery_draw_admin", collection: division.reverse_loaded_draws, as: :lottery_draw %>
        </div>
      </div>
    <% end %>
  </div>
</article>
